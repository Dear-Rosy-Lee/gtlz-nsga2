## 通用的球面问题

![image-20241203164829929](https://gitee.com/Dear-Rosy-Lee/picto-typora/raw/master/img/2024-12-03_16-48-32.png)

对于$i=1,2,\dots,M-1$,  $\theta_i=\pi/2*x_i$,

剩余的$n-m+1$长度的$\mathtt{x}$，定义为$\mathtt{r}$向量，$g(\mathtt{r})$可以调整

DTLZ问题关键组件

- 前m-1个决策变量用于确定目标的方向性
- 后续的变量调整目标函数的幅值和复杂性

$g(\mathtt{x}_M)=\sum_{i=1}^{d}(x_i-0.5)^2$

$f_1(\mathtt {x})=(1+g(x))\prod_{i=1}^{M-1}(cos(x_i^{\alpha}))$

$f_2(\mathtt{x})=(1+g(x))\prod_{i=1}^{M-2}cos(x_i^\alpha)sin(x_{M-1}^\alpha)$

$f_M(\mathtt{x}_M)=(1+g(x))sin(x_i^\alpha)$

# NSGA问题

## 支配、非支配解

对于两个解$\mathbf{x}^{(1)}$和$\mathbf{x}^{(2)}$,如果对于所有目标函数$f_i$都有:

$f_i(\mathbf{x}^{(1)}) \leq f_i(\mathbf{x}^{(2)})$

且至少存在一个目标函数$f_j$满足:

$f_j(\mathbf{x}^{(1)}) < f_j(\mathbf{x}^{(2)})$

则称解$\mathbf{x}^{(1)}$支配解$\mathbf{x}^{(2)}$,记作$\mathbf{x}^{(1)} \prec \mathbf{x}^{(2)}$

若两个解之间互不支配,则它们都是非支配解。在目标空间中,由非支配解构成的集合称为帕累托前沿(Pareto Front)。


## 非支配排序

对于$p\in P$,定义$S_p=\emptyset$为被$p$支配的解集合，$n_p=0$为支配$p$的解的数

定义支配关系$\prec$:
$\forall p$,$q \in P$, 若$\forall i \in \{1,\dots,m\}: f_i(p) \leq f_i(q)$ 且 $\exists j \in \{1,\dots,m\}: f_j(p) < f_j(q)$, 则称$p$支配$q$,记为$p \prec q$

对$\forall p$:
- $对于q \in P$:
    - 若$p \prec q$: $S_p = S_p \cup \{q\}$
    - 若$q \prec p$: $n_p = n_p + 1$

令前沿计数器$i=1$
定义第一非支配前沿$F_1 = \{p \in P | n_p = 0\}$

当$F_i \neq \emptyset$时:
- 令$Q = \emptyset$作为存储第$i+1$个前沿个体的集合
- 对于每个$p \in F_i$:
  - 对于每个$q \in S_p$:
    - $n_q = n_q - 1$
    - 若$n_q = 0$:
      - 令$q_{rank} = i + 1$
      - $Q = Q \cup \{q\}$
- $i = i + 1$
- 更新下一前沿$F_i = Q$

由此得到多个前沿，即F

## 拥挤度计算

对于每个前沿$F_i$,设其包含$n$个个体:

- 初始化所有个体的拥挤度为0: $F_i(d_j)=0$,其中$j$表示前沿$F_i$中第$j$个个体

- 对于每个目标函数$m$:
  - 根据目标$m$对前沿$F_i$中的个体进行排序,得到排序后的个体集合$I$
  - 将边界个体的拥挤度设为无穷大: $I(d_1)=\infty$, $I(d_n)=\infty$
  - 对于$k=2$到$n-1$:
    - $I(d_k) = I(d_k) + \frac{I(k+1).m - I(k-1).m}{f_m^{max} - f_m^{min}}$
    - 其中$I(k).m$表示排序后第$k$个个体在目标$m$上的函数值

在第m个维度上，从小到大排序后，相邻两个点的距离占整个排列范围的比值，越大说明越不拥挤，边界点有一边没有邻节点，所以距离视为无限。

拥挤度计算的基本思想是在$m$维目标空间中,根据$m$个目标计算同一前沿中每个个体之间的欧几里得距离。边界个体由于被赋予无穷大的拥挤度值,总是会被选择。

## 选择

在完成非支配排序和拥挤度计算后,使用拥挤度比较算子(≺n)进行选择。比较规则如下:

对于个体p和q,若满足以下条件之一,则p ≺n q:

1. p的非支配等级小于q: prank < qrank
2. 若p和q属于同一前沿Fi,则p的拥挤度大于q: Fi(dp) > Fi(dq)

选择过程采用二元锦标赛选择法,结合拥挤度比较算子。具体步骤为:

1. 从种群中随机选择两个个体
2. 使用拥挤度比较算子对这两个个体进行比较
3. 胜出的个体被选中进入下一代

这种选择机制既保证了更好的非支配解有更大的机会被选中,同时也通过拥挤度的比较保持了种群的多样性。拥挤度较大的个体(即周围较不拥挤的个体)会被优先选择,有助于解集在Pareto前沿上均匀分布。

### 二元锦标赛选择法

二元锦标赛选择法是一种**有放回抽样**的方法。在每次选择过程中，个体可以被多次选中进入下一代。具体步骤如下：

- **随机选择**：从种群中随机选择两个个体。
- **比较**：根据非支配等级和拥挤度对这两个个体进行比较。
- **选择**：选择其中较优的个体进入下一代。

这个过程会重复进行，直到新一代的种群达到所需的大小。二元锦标赛选择法的优点在于其简单性和有效性，能够在保持种群多样性的同时，优先选择更优的个体。


## 遗传算子

NSGA-II使用模拟二进制交叉(Simulated Binary Crossover, SBX)和多项式变异(Polynomial Mutation)作为遗传算子。

### 模拟二进制交叉

模拟二进制交叉模拟了自然界中的二进制交叉过程,其计算公式如下:

$c_{1,k} = \frac{1}{2}[(1-\beta_k)p_{1,k} + (1+\beta_k)p_{2,k}]$

$c_{2,k} = \frac{1}{2}[(1+\beta_k)p_{1,k} + (1-\beta_k)p_{2,k}]$

其中:
- $c_{i,k}$ 表示第$i$个子代的第$k$个分量
- $p_{i,k}$ 表示选中的父代
- $\beta_k \geq 0$ 是从一个随机数分布中采样得到的值

$\beta_k$ 的概率密度函数为（理论曲线）:

$p(\beta) = \frac{1}{2}(\eta_c + 1)\beta^{\eta_c}$, 当 $0 \leq \beta \leq 1$

$p(\beta) = \frac{1}{2}(\eta_c + 1)\frac{1}{\beta^{\eta_c+2}}$, 当 $\beta > 1$

该分布可以通过均匀分布在$(0,1)$区间上的随机数$u$获得,其中$\eta_c$是交叉分布指数（实际的$\beta$获取方式）:

$\beta(u) = (2u)^{\frac{1}{\eta_c+1}}$, 当 $u \leq 0.5$

$\beta(u) = \frac{1}{[2(1-u)]^{\frac{1}{\eta_c+1}}}$, 当 $u > 0.5$

### 多项式变异

多项式变异是一种局部搜索算子,其计算公式如下:

$c_k = p_k + (p_k^u - p_k^l)\delta_k$

其中:
- $c_k$ 表示变异后的子代
- $p_k$ 表示父代
- $p_k^u$ 和 $p_k^l$ 分别表示第$k$个决策变量的上下界
- $\delta_k$ 是从多项式分布中采样得到的小扰动

$\delta_k$ 的计算公式为:

$\delta_k = (2r_k)^{\frac{1}{\eta_m+1}} - 1$, 当 $r_k < 0.5$

$\delta_k = 1 - [2(1-r_k)]^{\frac{1}{\eta_m+1}}$, 当 $r_k \geq 0.5$

其中:
- $r_k$ 是在$(0,1)$区间上均匀采样的随机数
- $\eta_m$ 是变异分布指数

## 重组与选择

NSGA-II的重组与选择过程如下:

1. 将子代种群与当前种群合并
2. 对合并后的种群进行非支配排序
3. 按照非支配等级从低到高依次选择个体进入下一代,直到种群规模达到要求
4. 如果最后一个被选择的非支配等级(记为$F_j$)中的个体无法全部进入下一代,则根据拥挤度降序排列,选择拥挤度较大的个体

这种选择机制确保了:
- 精英保留策略:保留了父代和子代中最优的个体
- 种群多样性:通过拥挤度比较维持种群在Pareto前沿上的均匀分布



